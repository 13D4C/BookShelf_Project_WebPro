import{a as m,t as f}from"../chunks/BpdS5ozQ.js";import"../chunks/ak-IiZ70.js";import{p as he,l as y,d as we,f as xe,a as ke,b as d,c as s,r,s as l,t as P,g as e,n as ye,m as p,e as Pe,i as V}from"../chunks/BkNIMPUX.js";import{s as w}from"../chunks/8GdiTE-D.js";import{i as W}from"../chunks/BO1fjogy.js";import{e as X,i as Le}from"../chunks/DCYGmzsl.js";import{r as Ce,s as L}from"../chunks/H21sVsVO.js";import{e as Se}from"../chunks/BpZ3buzO.js";import{t as Y,q as je,a as Te,f as $e}from"../chunks/pl10jhQ3.js";import{b as qe}from"../chunks/BzbwHmVE.js";import{b as J}from"../chunks/CqdXf88-.js";import{i as Ae}from"../chunks/CPaK9zB5.js";import{s as He,a as Oe}from"../chunks/Cu0EAYA7.js";import{o as Be,w as De}from"../chunks/BrBxsZ45.js";import{g as Ee}from"../chunks/CPiIr9-y.js";var Ie=f('<div class="fixed inset-0 flex items-center justify-center bg-blue-50 z-50"><div class="spinner animate-spin w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full"></div></div>'),ze=f("<option> </option>"),Me=f("<p>Loading products...</p>"),Re=f('<div class="bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition duration-200 h-full flex flex-col"><img class="w-full h-48 object-cover rounded-t-lg"> <div class="p-4"><h2 class="text-xl font-semibold mb-2"> </h2> <p class="text-gray-600 mb-2 line-clamp-12"> </p></div> <div class="mt-auto"><div class="flex items-center"><img class="w-8 h-8 rounded-full mr-2"> <p> </p></div> <p class="text-green-600 font-bold text-lg mb-2"> </p> <button class="mt-2 w-full bg-blue-500 text-white py-2 rounded">ซื้อเลย</button></div></div>'),Ue=f('<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>'),Fe=f('<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-4">Marketplace</h1> <div class="mb-4 flex flex-col md:flex-row gap-4"><input type="text" placeholder="Search..." class="border p-2 rounded w-full md:w-1/2"> <select class="border p-2 rounded w-full md:w-1/4"><option>All Categories</option><!></select> <select class="border p-2 rounded w-full md:w-1/4"><option>Sort By</option><option>Price: Low to High</option><option>Price: High to Low</option><option>Newest</option></select></div> <!></div>'),Ge=f('<!> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer">',1);function lo(Z,ee){he(ee,!1);const[oe,te]=He(),re=()=>Oe(R,"$isLoading",oe),x=p(),C=p(),M=p(),S=p();let u=p([]);const R=De(!0);let U=p(!0),b=p(""),g=p(null),_=p(null);async function ae(){try{const t=await fetch("http://localhost:3000/seller/books?all=true");if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);d(u,await t.json()),d(U,!1)}catch(o){console.error("Error fetching books:",o),d(u,[])}finally{R.set(!1)}}Be(async()=>{localStorage.getItem("userToken"),await ae()});function se(o){Ee(`/marketdetails/${o}`)}y(()=>(e(g),e(u)),()=>{d(x,e(g)?e(u).filter(o=>o.book_category===e(g)):e(u))}),y(()=>(e(b),e(x)),()=>{d(C,e(b)?e(x).filter(o=>o.book_name.toLowerCase().includes(e(b).toLowerCase())||o.description.toLowerCase().includes(e(b).toLowerCase())):e(x))}),y(()=>(e(C),e(_)),()=>{d(M,(()=>{let o=[...e(C)];return e(_)==="price-asc"?o.sort((t,n)=>t.book_price-n.book_price):e(_)==="price-desc"?o.sort((t,n)=>n.book_price-t.book_price):e(_)==="newest"&&o.sort((t,n)=>n.seller_book_idid-t.seller_book_idid),o})())}),y(()=>e(u),()=>{d(S,[...new Set(e(u).map(o=>o.book_category))])}),we(),Ae();var F=Ge(),le=xe(F);{var ie=o=>{var t=Ie(),n=s(t);r(t),Y(3,n,()=>Te,()=>({duration:300,easing:je})),Y(3,t,()=>$e,()=>({duration:300})),m(o,t)},ne=o=>{var t=Fe(),n=l(s(t),2),j=s(n);Ce(j);var k=l(j,2);P(()=>{e(g),V(()=>{e(S)})});var T=s(k);T.value=(T.__value=null)==null?"":null;var ce=l(T);X(ce,1,()=>e(S),Le,(a,c)=>{var v=ze(),i={},h=s(v,!0);r(v),P(()=>{i!==(i=e(c))&&(v.value=(v.__value=e(c))==null?"":e(c)),w(h,e(c))}),m(a,v)}),r(k);var $=l(k,2);P(()=>{e(_),V(()=>{})});var q=s($);q.value=(q.__value=null)==null?"":null;var A=l(q);A.value=(A.__value="price-asc")==null?"":"price-asc";var H=l(A);H.value=(H.__value="price-desc")==null?"":"price-desc";var G=l(H);G.value=(G.__value="newest")==null?"":"newest",r($),r(n);var de=l(n,2);{var ve=a=>{var c=Me();m(a,c)},pe=a=>{var c=Ue();X(c,5,()=>e(M),v=>v.seller_book_id,(v,i)=>{var h=Re(),O=s(h),B=l(O,2),D=s(B),ue=s(D,!0);r(D);var K=l(D,2),_e=s(K,!0);r(K),r(B);var N=l(B,2),E=s(N),I=s(E),Q=l(I,2),me=s(Q,!0);r(Q),r(E);var z=l(E,2),fe=s(z);r(z);var be=l(z,2);r(N),r(h),P(ge=>{L(O,"src",e(i).book_image),L(O,"alt",e(i).book_name),w(ue,e(i).book_name),w(_e,e(i).description),L(I,"src",e(i).user_image),L(I,"alt",e(i).user_name),w(me,e(i).user_name),w(fe,`฿${ge??""}`)},[()=>e(i).book_price.toLocaleString()],Pe),Se("click",be,()=>se(e(i).seller_book_id)),m(v,h)}),r(c),m(a,c)};W(de,a=>{e(U)?a(ve):a(pe,!1)})}r(t),qe(j,()=>e(b),a=>d(b,a)),J(k,()=>e(g),a=>d(g,a)),J($,()=>e(_),a=>d(_,a)),m(o,t)};W(le,o=>{re()?o(ie):o(ne,!1)})}ye(2),m(Z,F),ke(),te()}export{lo as component};
