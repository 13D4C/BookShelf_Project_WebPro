import{c as gt,a as b,t as g}from"../chunks/BpdS5ozQ.js";import"../chunks/ak-IiZ70.js";import{p as mt,l as se,d as ht,f as le,a as xt,b as p,g as e,c as o,r as t,s as r,n as Ue,m as j,t as H,h as u,i as De}from"../chunks/BkNIMPUX.js";import{s as L}from"../chunks/8GdiTE-D.js";import{i as E}from"../chunks/BO1fjogy.js";import{e as I,i as R}from"../chunks/DCYGmzsl.js";import{r as ne,s as Le}from"../chunks/H21sVsVO.js";import{t as Ie}from"../chunks/20z5p9mC.js";import{e as x,r as Re}from"../chunks/BpZ3buzO.js";import{t as ze,s as yt,q as kt,a as wt,f as $t}from"../chunks/pl10jhQ3.js";import{b as G}from"../chunks/BzbwHmVE.js";import{b as Je}from"../chunks/CqdXf88-.js";import{i as St}from"../chunks/CPaK9zB5.js";import{s as Tt,a as Ge}from"../chunks/Cu0EAYA7.js";import"../chunks/CPiIr9-y.js";import{o as jt,w as Ct}from"../chunks/BrBxsZ45.js";import{p as Bt}from"../chunks/BQ7FjgTO.js";import{b as Pt}from"../chunks/Bt-Xh7oU.js";import{B as Ft,C as Ht}from"../chunks/WWqWQjrX.js";import{F as We,D as Mt}from"../chunks/6eaVWb4c.js";var qt=g('<div class="fixed inset-0 flex items-center justify-center bg-blue-50 z-50"><div class="spinner animate-spin w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full"></div></div>'),At=g("<!>Filter",1),Et=g('<li class="text-blue-600 cursor-pointer hover:underline"> </li>'),Nt=g('<div class="flex items-center"><h5 id="drawer-label" class="inline-flex items-center mb-4 text-base font-semibold text-gray-500 dark:text-gray-400"><!>Filter</h5> <!></div> <h2 class="text-xl font-semibold text-blue-700">หมวดหมู่</h2> <ul class="mt-2 space-y-2"><li class="text-blue-600 cursor-pointer hover:underline">ทั้งหมด</li> <!></ul>',1),Ot=g('<li class="text-blue-600 cursor-pointer hover:underline"> </li>'),Ut=g('<div class="mb-4"><button class="mt-2 w-full bg-blue-800 text-white py-2 rounded">เพิ่มหนังสือ</button></div>'),Dt=g('<button class="mt-2 w-full bg-blue-500 text-white py-2 rounded">เเก้ไขหนังสือ</button>'),Lt=g('<button data-modal-target="popup-modal" data-modal-toggle="popup-modal" class="mt-2 w-full bg-blue-500 text-white py-2 rounded">ลบหนังสือ</button>'),It=g('<div class="book-card border border-blue-500 rounded-lg shadow-lg bg-white flex flex-col"><div class="p-4"><img class="object-contain w-full h-[200px] rounded"></div> <div class="px-4 pb-4 flex-grow"><p class="font-semibold text-blue-700 truncate"> </p> <!> <!></div></div>'),Rt=g("<p>No books in this category.</p>"),zt=g('<div class="fixed inset-0 bg-gray-500 bg-opacity-40 flex justify-center items-center z-50"><div class="bg-white p-8 rounded-lg shadow-xl w-96 max-w-sm space-y-6 border"><h2 class="text-2xl font-semibold text-gray-800">⚠️ คำเตือน</h2> <p class="text-gray-600">การลบจะไม่สามารถย้อนกลับได้ คุณต้องการลบหนังสือเล่มนี้หรือไม่?</p> <div class="flex justify-end space-x-4"><button class="bg-red-500 text-white p-2 pl-5 pr-5 rounded-lg hover:bg-red-600">ยกเลิก</button> <button class="bg-green-500 text-white p-2 pl-5 pr-5 rounded-lg hover:bg-green-600">ยืนยัน</button></div></div></div>'),Jt=g('<span class="bg-blue-500 text-white px-3 py-1 rounded-full"> </span>'),Gt=g("<option> </option>"),Wt=g("<p>❌การเพิ่มหนังสือไม่สำเร็จ กรุณาลองใหม่ภายหลัง</p>"),Vt=g('<div class="fixed inset-0 bg-gray-500 bg-opacity-40 flex justify-center items-center z-50"><div class="bg-white p-10 rounded-lg shadow-xl w-[65vw] max-w-3xl max-h-[90vh] space-y-6 border overflow-y-auto"><h2 class="text-2xl font-semibold text-gray-800">📖 เพิ่มหนังสือ</h2> <form><div class="space-y-4"><div><label for="bookName" class="block text-gray-600">ชื่อหนังสือ</label> <input id="bookName" type="text" class="w-full px-4 py-2 border rounded-lg shadow-sm" required></div> <div><div class="mt-4"><p class="text-gray-600">หมวดหมู่ที่เลือก:</p> <div class="flex flex-wrap gap-2 mt-2"></div></div> <label for="category" class="block text-gray-600">หมวดหมู่</label> <select id="categories" multiple class="w-full px-4 py-2 border rounded-lg shadow-sm"></select></div> <div><label for="description" class="block text-gray-600">รายระเอียดหนังสือ</label> <textarea id="description" rows="3" class="w-full px-4 py-2 border rounded-lg shadow-sm" required></textarea></div> <div><label for="price" class="block text-gray-600">ราคาหนังสือ</label> <input id="price" type="number" class="w-full px-4 py-2 border rounded-lg shadow-sm" required></div> <div><label for="image" class="block text-gray-600">รูปภาพ</label> <input id="image" type="file" accept="image/*" class="w-full px-4 py-2 border rounded-lg shadow-sm"></div></div> <div class="flex justify-end space-x-4 mt-6"><button type="button" class="bg-red-500 text-white p-2 pl-5 pr-5 rounded-lg hover:bg-red-600">ยกเลิก</button> <button type="submit" class="bg-green-500 text-white p-2 pl-5 pr-5 rounded-lg hover:bg-green-600">เพิ่ม</button></div> <!></form></div></div>'),Yt=g('<span class="bg-blue-500 text-white px-3 py-1 rounded-full"> </span>'),Kt=g("<option> </option>"),Qt=g("<p>❌การเเก้ไขหนังสือไม่สำเร็จ กรุณาลองใหม่ภายหลัง</p>"),Xt=g('<div class="fixed inset-0 bg-gray-500 bg-opacity-40 flex justify-center items-center z-50"><div class="bg-white p-10 rounded-lg shadow-xl w-[65vw] max-w-3xl max-h-[90vh] space-y-6 border overflow-y-auto"><h2 class="text-2xl font-semibold text-gray-800">📖 เเก้ไขหนังสือ</h2> <form><div class="space-y-4"><div><label for="bookNameTH" class="block text-gray-600">ชื่อหนังสือ</label> <input id="bookNameTH" type="text" class="w-full px-4 py-2 border rounded-lg shadow-sm" required></div> <div><div class="mt-4"><p class="text-gray-600">หมวดหมู่ที่เลือก:</p> <div class="flex flex-wrap gap-2 mt-2"></div></div> <label for="category" class="block text-gray-600">หมวดหมู่</label> <select id="categories" multiple class="w-full px-4 py-2 border rounded-lg shadow-sm"></select></div> <div><label for="description" class="block text-gray-600">รายระเอียดหนังสือ</label> <textarea id="description" rows="3" class="w-full px-4 py-2 border rounded-lg shadow-sm" required></textarea></div> <div><label for="price" class="block text-gray-600">ราคาหนังสือ</label> <input id="price" type="number" class="w-full px-4 py-2 border rounded-lg shadow-sm" required></div> <div><label for="image" class="block text-gray-600">รูปภาพ</label> <input id="image" type="file" accept="image/*" class="w-full px-4 py-2 border rounded-lg shadow-sm"></div></div> <div class="flex justify-end space-x-4 mt-6"><button type="button" class="bg-red-500 text-white p-2 pl-5 pr-5 rounded-lg hover:bg-red-600">ยกเลิก</button> <button type="submit" class="bg-green-500 text-white p-2 pl-5 pr-5 rounded-lg hover:bg-green-600">บันทึก</button></div> <!></form></div></div>'),Zt=g('<div class="min-h-screen bg-white"><div class="max-w-6xl mx-auto p-4"><div class="flex items-center justify-between mb-4"><h1 class="text-3xl font-bold text-blue-700">หนังสือทั้งหมดของผู้ขาย</h1> <!></div> <!> <div class="flex gap-4"><aside class="hidden lg:block w-[20%] border border-blue-500 p-4 rounded-lg bg-blue-50 h-fit"><h2 class="text-xl font-semibold text-blue-700">หมวดหมู่</h2> <ul class="mt-2 space-y-2"><li class="text-blue-600 cursor-pointer hover:underline">ทั้งหมด</li> <!></ul></aside> <div class="md:container md:mx-auto"><!> <div class="md:container md:mx-auto grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"></div></div></div></div></div> <!> <!> <!>',1);function yo(Ve,Ye){mt(Ye,!1);const[me,Ke]=Tt(),he=()=>Ge(Bt,"$page",me),Qe=()=>Ge(ke,"$isLoading",me),X=j();let Z=j(!0),Xe={x:-320,duration:200,easing:yt},U=j([]),ee,te=j([]),z=j(null),F=j(),W=[],xe=j(!1),N=j(!1),i=j({book_name:"",book_category:[],description:"",book_price:0,book_image:"",owner_id:""}),s=j({book_name:"",book_category:[],description:"",book_price:0,book_image:""}),de=j(!1),ce=j(!1),ve=j(!1),oe=0,V=0,ye=["Fiction","Fantasy","Science Fiction","Mystery","Horror","Romance","Historical Fiction","Literary Fiction","Young Adult","Children","Graphic Novels","Dystopian","Action","Western","Nonfiction","History","Biography/Autobiography","Self-help","Science & Technology","Health & Wellness","Business & Economics","True Crime","Travel","Cookbooks","Art & Photography","Religion & Spirituality","Philosophy","Humor","Essays","Reference","Girl Love","Boy Love","R18+","Light Novel","Manga","Manwha","manhua","Comic","SuperHero","Drama","Adventure"];const ke=Ct(!0);function Ze(a){let n=new Set;return a.forEach(m=>{m.book_category&&m.book_category.split(",").forEach(M=>{n.add(M)})}),Array.from(n)}async function Y(){try{p(F,await et());let a;if(e(F))switch(e(F).user_permission){case"Seller":a=`http://localhost:3000/seller/books?ownerId=${e(F).user_id}`;break;case"Manager":a="http://localhost:3000/seller/books?all=true";break}else return null;const n=await fetch(a);if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);p(U,await n.json()),p(te,Ze(e(U)))}catch(a){console.error("Error fetching books:",a),p(U,[]),p(te,[])}finally{ke.set(!1)}}async function et(){try{if(Pt)return ee||(ee=localStorage.getItem("userToken")),(await fetch("http://localhost:3000/user/getUserProfile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:ee})})).json()}catch(a){console.log(a)}}function re(a){p(z,a),ue()}jt(async()=>{W=document.querySelectorAll(".book-card"),ee=localStorage.getItem("userToken"),await Y()});function ue(){if(!W.length)return;let a=0;W.forEach(n=>{n.style.height="auto"}),W.forEach(n=>{a=Math.max(a,n.offsetHeight)}),W.forEach(n=>{n.style.height=`${a}px`})}async function tt(){const a=await fetch(`http://localhost:3000/seller/books/delete/${oe}`);if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);oe=0,we(),await Y()}function ot(a){p(de,!0),oe=a}function we(){p(de,!1),oe=0}function rt(){p(ce,!0)}function $e(){Ce(),p(ce,!1),p(N,!1)}async function at(a){const m=await(await fetch(`http://localhost:3000/seller/books?id=${a}`)).json();u(s,e(s).book_name=m.book_name),u(s,e(s).book_category=m.book_category),u(s,e(s).book_category=m.book_category.split(",")),u(s,e(s).description=m.description),u(s,e(s).book_price=m.book_price),u(s,e(s).book_image=m.book_image),p(ve,!0),V=a}function Se(){p(ve,!1),V=0,p(N,!1)}async function it(){try{u(i,e(i).owner_id=await e(F).user_id),u(i,e(i).book_category=await e(i).book_category.join(",")),(await fetch("http://localhost:3000/seller/books/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e(i))})).ok?(Ce(),$e(),Y()):p(N,!0)}catch(a){p(N,!0),console.log(a)}}async function Te(a){const n=a.target.files[0];if(n)try{u(i,e(i).book_image=await je(n)),u(s,e(s).book_image=await je(n))}catch(m){console.error("Error converting to base64:",m)}}function je(a){return new Promise((n,m)=>{const O=new FileReader;O.onload=()=>{const M=O.result;n(M)},O.onerror=M=>{m(M)},O.readAsDataURL(a)})}function Ce(){u(i,e(i).book_name=""),u(i,e(i).book_category=[]),u(i,e(i).description=""),u(i,e(i).book_price=0),u(i,e(i).book_image=""),u(i,e(i).owner_id="")}async function st(){try{u(s,e(s).book_category=await e(s).book_category.join(",")),console.log(e(s)),(await fetch(`http://localhost:3000/seller/books/update/book/${V}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e(s))})).ok?(Se(),Y(),V=0):(p(N,!0),V=0)}catch(a){p(N,!0),console.log(a)}}function ae(){p(xe,e(i).book_name&&e(i).description&&e(i).book_price&&e(i).book_category)}se(()=>(e(U),e(z)),()=>{p(X,(()=>{let a=e(U);return e(z)!==null&&(a=a.filter(n=>n.book_category&&n.book_category.includes(e(z)))),a})())}),se(()=>e(U),()=>{e(U).length>0&&ue()}),se(()=>e(X),()=>{e(X)&&ue()}),se(()=>he(),()=>{he().url&&Y()}),ht(),St();var Be=gt(),lt=le(Be);{var nt=a=>{var n=qt(),m=o(n);t(n),ze(3,m,()=>wt,()=>({duration:300,easing:kt})),ze(3,n,()=>$t,()=>({duration:300})),b(a,n)},dt=a=>{var n=Zt(),m=le(n),O=o(m),M=o(O),ct=r(o(M),2);Ft(ct,{class:"block lg:hidden",$$events:{click:()=>p(Z,!1)},children:(c,d)=>{var v=At(),_=le(v);We(_,{class:"w-5 h-5 me-2.5"}),Ue(),b(c,v)},$$slots:{default:!0}}),t(M);var Pe=r(M,2);Mt(Pe,{transitionType:"fly",transitionParams:Xe,id:"sidebar1",get hidden(){return e(Z)},set hidden(c){p(Z,c)},children:(c,d)=>{var v=Nt(),_=le(v),y=o(_),$=o(y);We($,{class:"w-5 h-5 me-2.5 place-content-center"}),Ue(),t(y);var C=r(y,2);Ht(C,{class:"mb-4 dark:text-white",$$events:{click:()=>p(Z,!0)}}),t(_);var B=r(_,4),S=o(B),q=r(S,2);I(q,1,()=>e(te),R,(P,T)=>{var f=Et(),w=o(f,!0);t(f),H(()=>{Ie(f,"font-bold",e(z)===e(T)),L(w,e(T))}),x("click",f,()=>re(e(T))),b(P,f)}),t(B),x("click",S,()=>re(null)),b(c,v)},$$slots:{default:!0},$$legacy:!0});var Fe=r(Pe,2),pe=o(Fe),He=r(o(pe),2),Me=o(He),vt=r(Me,2);I(vt,1,()=>e(te),R,(c,d)=>{var v=Ot(),_=o(v,!0);t(v),H(()=>{Ie(v,"font-bold",e(z)===e(d)),L(_,e(d))}),x("click",v,()=>re(e(d))),b(c,v)}),t(He),t(pe);var qe=r(pe,2),Ae=o(qe);{var ut=c=>{var d=Ut(),v=o(d);t(d),x("click",v,rt),b(c,d)};E(Ae,c=>{e(F).user_permission!="Manager"&&e(F).user_permission!="User"&&c(ut)})}var Ee=r(Ae,2);I(Ee,5,()=>e(X),R,(c,d)=>{var v=It(),_=o(v),y=o(_);t(_);var $=r(_,2),C=o($),B=o(C,!0);t(C);var S=r(C,2);{var q=f=>{var w=Dt();x("click",w,()=>at(e(d).seller_book_id)),b(f,w)};E(S,f=>{e(F).user_permission!="User"&&e(F).user_permission!="Publisher"&&f(q)})}var P=r(S,2);{var T=f=>{var w=Lt();x("click",w,()=>ot(e(d).seller_book_id)),b(f,w)};E(P,f=>{e(F).user_permission!="User"&&e(F).user_permission!="Publisher"&&f(T)})}t($),t(v),H(()=>{Le(y,"src",e(d).book_image),Le(y,"alt",e(d).book_name),L(B,e(d).book_name)}),b(c,v)},c=>{var d=Rt();b(c,d)}),t(Ee),t(qe),t(Fe),t(O),t(m);var Ne=r(m,2);{var pt=c=>{var d=zt(),v=o(d),_=r(o(v),4),y=o(_),$=r(y,2);t(_),t(v),t(d),x("click",y,we),x("click",$,tt),b(c,d)};E(Ne,c=>{e(de)&&c(pt)})}var Oe=r(Ne,2);{var bt=c=>{var d=Vt(),v=o(d),_=r(o(v),2),y=o(_),$=o(y),C=r(o($),2);ne(C),t($);var B=r($,2),S=o(B),q=r(o(S),2);I(q,5,()=>e(i).book_category,R,(l,k)=>{var h=Jt(),A=o(h,!0);t(h),H(()=>L(A,e(k))),b(l,h)}),t(q),t(S);var P=r(S,4);H(()=>{e(i),De(()=>{})}),I(P,5,()=>ye,R,(l,k)=>{var h=Gt(),A={},ge=o(h,!0);t(h),H(()=>{A!==(A=e(k))&&(h.value=(h.__value=e(k))==null?"":e(k)),L(ge,e(k))}),b(l,h)}),t(P),t(B);var T=r(B,2),f=r(o(T),2);Re(f),t(T);var w=r(T,2),J=r(o(w),2);ne(J),t(w);var K=r(w,2),be=r(o(K),2);t(K),t(y);var D=r(y,2),Q=o(D),ie=r(Q,2);t(D);var _e=r(D,2);{var fe=l=>{var k=Wt();b(l,k)};E(_e,l=>{e(N)&&l(fe)})}t(_),t(v),t(d),H(()=>ie.disabled=!e(xe)),G(C,()=>e(i).book_name,l=>u(i,e(i).book_name=l)),x("input",C,ae),x("input",P,ae),Je(P,()=>e(i).book_category,l=>u(i,e(i).book_category=l)),G(f,()=>e(i).description,l=>u(i,e(i).description=l)),x("input",f,ae),G(J,()=>e(i).book_price,l=>u(i,e(i).book_price=l)),x("input",J,ae),x("change",be,Te),x("click",Q,$e),x("click",ie,it),b(c,d)};E(Oe,c=>{e(ce)&&c(bt)})}var _t=r(Oe,2);{var ft=c=>{var d=Xt(),v=o(d),_=r(o(v),2),y=o(_),$=o(y),C=r(o($),2);ne(C),t($);var B=r($,2),S=o(B),q=r(o(S),2);I(q,5,()=>e(s).book_category,R,(l,k)=>{var h=Yt(),A=o(h,!0);t(h),H(()=>L(A,e(k))),b(l,h)}),t(q),t(S);var P=r(S,4);H(()=>{e(s),De(()=>{})}),I(P,5,()=>ye,R,(l,k)=>{var h=Kt(),A={},ge=o(h,!0);t(h),H(()=>{A!==(A=e(k))&&(h.value=(h.__value=e(k))==null?"":e(k)),L(ge,e(k))}),b(l,h)}),t(P),t(B);var T=r(B,2),f=r(o(T),2);Re(f),t(T);var w=r(T,2),J=r(o(w),2);ne(J),t(w);var K=r(w,2),be=r(o(K),2);t(K),t(y);var D=r(y,2),Q=o(D),ie=r(Q,2);t(D);var _e=r(D,2);{var fe=l=>{var k=Qt();b(l,k)};E(_e,l=>{e(N)&&l(fe)})}t(_),t(v),t(d),G(C,()=>e(s).book_name,l=>u(s,e(s).book_name=l)),Je(P,()=>e(s).book_category,l=>u(s,e(s).book_category=l)),G(f,()=>e(s).description,l=>u(s,e(s).description=l)),G(J,()=>e(s).book_price,l=>u(s,e(s).book_price=l)),x("change",be,Te),x("click",Q,Se),x("click",ie,st),b(c,d)};E(_t,c=>{e(ve)&&c(ft)})}x("click",Me,()=>re(null)),b(a,n)};E(lt,a=>{Qe()?a(nt):a(dt,!1)})}b(Ve,Be),xt(),Ke()}export{yo as component};
