import{a as v,t as c}from"../chunks/BpdS5ozQ.js";import"../chunks/ak-IiZ70.js";import{p as Pa,m as g,l as La,d as Sa,f as Ia,a as Oa,g as a,c as o,s as i,r as e,b as s,t as C,M as za}from"../chunks/BkNIMPUX.js";import{s as M}from"../chunks/8GdiTE-D.js";import{i as h}from"../chunks/BO1fjogy.js";import{e as ia,i as la}from"../chunks/DCYGmzsl.js";import{s as F,h as Ca}from"../chunks/H21sVsVO.js";import{e as x,r as Fa}from"../chunks/BpZ3buzO.js";import{b as Na}from"../chunks/BzbwHmVE.js";import{i as qa}from"../chunks/CPaK9zB5.js";import{s as Aa,a as da}from"../chunks/Cu0EAYA7.js";import{g as na}from"../chunks/CPiIr9-y.js";import{p as Da}from"../chunks/BQ7FjgTO.js";import{o as Ha,w as Ja}from"../chunks/BrBxsZ45.js";import{g as Ua}from"../chunks/C42RF6-C.js";var Ga=c('<p class="text-red-500"> </p>'),Ka=c('<div class="animate-pulse"><div class="h-64 bg-gray-300 rounded-lg"></div> <div class="mt-4 space-y-2"><div class="h-6 bg-gray-300 rounded"></div> <div class="h-4 bg-gray-300 rounded w-3/4"></div> <div class="h-4 bg-gray-300 rounded w-1/2"></div></div></div>'),Qa=c('<div class="max-w-xs"><img class="w-full rounded-lg object-cover"></div>'),Va=c('<div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="relative"><!></div> <div class="space-y-4"><h1 class="text-3xl font-bold"> </h1> <p class="text-2xl text-red-600 font-semibold"> </p> <div class="flex items-center"><label class="mr-2 text-lg">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label> <button class="px-4 py-2 bg-gray-500 rounded text-xl">-</button> <span class="px-4 text-xl"> </span> <button class="px-4 py-2 bg-gray-300 rounded text-xl">+</button></div> <div class="flex gap-4"><button class="px-8 py-3 border border-orange-500 text-orange-500 rounded text-lg">‡πÉ‡∏™‡πà‡∏£‡∏ñ‡πÄ‡∏Ç‡πá‡∏ô</button></div> <div class="mt-8"><h2 class="text-xl font-semibold">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î :</h2> <p class="text-gray-600 mt-2"> </p></div></div></div>'),Wa=c('<div class="bg-gray-200 h-40 rounded-lg animate-pulse"></div>'),Xa=c('<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4"></div>'),Ya=c('<img class="h-48 w-96 object-scale-down place-content-center" loading="lazy">'),Za=c('<div class="bg-gray-200 h-40 rounded-lg overflow-hidden"><!></div>'),at=c("<p>No related books found.</p>"),tt=c('<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4"></div>'),et=c('<div class="min-h-screen bg-blue-50"><div class="max-w-5xl mx-auto p-6"><!> <!> <div class="mt-8"><button class="bg-blue-700 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">üì¢ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏•‡πà‡∏°‡∏ô‡∏µ‡πâ</button></div> <div class="mt-8"><h2 class="text-xl font-semibold">‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</h2> <!></div></div></div>'),ot=c('<div class="fixed inset-0 bg-gray-500 bg-opacity-40 flex justify-center items-center z-50 transform"><div class="bg-white p-10 rounded-lg shadow-xl w-[65vw] max-w-xl max-h-[50vh] space-y-6 border overflow-y-auto"><h2 class="text-2xl font-semibold text-gray-800">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</h2> <form><div class="space-y-4"><div><label for="reason" class="block text-gray-600">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</label> <textarea id="reason" class="w-full px-4 py-2 border rounded-lg shadow-sm svelte-j2l5j9" required></textarea></div></div> <div class="flex justify-end space-x-4 mt-6"><button type="button" class="bg-red-500 text-white p-2 pl-5 pr-5 rounded-lg hover:bg-red-600">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button> <button type="button" class="bg-green-500 text-white p-2 pl-5 pr-5 rounded-lg hover:bg-green-600">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button></div></form></div></div>'),rt=c("<!> <!>",1);function xt(va,ca){Pa(ca,!1);const[W,pa]=Aa(),T=()=>da(Da,"$page",W),fa=()=>da(Y,"$isLoading",W);let p=g({}),y=g(1),R=g([]),P=g(!0),N=g(!0),k=g(""),q,X,A=g(T().params.id),D=g(!0),H=g(!1),L=g("");Ha(async()=>{q=localStorage.getItem("userToken"),await Ua(q).then(r=>{X=r.user_id})});function ga(r){na(`/marketdetails/${r}`)}async function _a(r){s(N,!0),s(P,!0),s(k,"");try{const t=await fetch(`http://localhost:3000/seller/books?id=${r}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.json();n?s(p,n):(s(p,{}),s(k,"Book not found"))}catch(t){console.error("Error fetching main book details:",t),s(k,"Failed to load book details. Please try again later.")}finally{s(N,!1),Y.set(!1)}if(a(p).owner_id)try{const t=await fetch(`http://localhost:3000/seller/books?ownerId=${a(p).owner_id}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.json();s(R,n)}catch(t){console.error("Error fetching related books:",t),s(k,"Failed to load related books."),s(R,[])}finally{s(P,!1)}else s(R,[]),s(P,!1)}const Y=Ja(!0);async function ua(r,t){try{const n=await fetch("http://localhost:3000/shop/seller/cart/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seller_book_id:r,token:q,amount:t})});if(!n.ok){if(n.status===404)throw alert("Book not found"),new Error("Book not found");const u=await n.json();throw new Error(`Failed to add to cart: ${u.error} - ${u.details}`)}na(T().url)}catch(n){console.error("Error adding to cart:",n),alert("Add to cart failed")}}function ba(){s(H,!0)}function Z(){s(H,!1)}async function ma(){try{const r=await fetch("http://localhost:3000/report/book/seller",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seller_book_id:a(p).seller_book_id,reporter_id:X,report_reason:a(L)})}),t=await r.json();if(!r.ok){t.error=="Book is not found"||t.error=="User is not found"?alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠"):t.error=="This user has already reported"&&alert("‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏¢‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏•‡πà‡∏°‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÄ‡πÄ‡∏•‡πâ‡∏ß");return}alert("‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à")}catch(r){console.log(r),alert("‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á")}finally{Z(),s(L,"")}}La(()=>(T(),a(D),a(A)),()=>{(T().params.id||a(D))&&(s(y,1),s(A,T().params.id),_a(a(A)),s(D,!1))}),Sa(),qa();var aa=rt(),ta=Ia(aa);{var ha=r=>{},xa=r=>{var t=et(),n=o(t),u=o(n);{var $=l=>{var d=Ga(),f=o(d,!0);e(d),C(()=>M(f,a(k))),v(l,d)};h(u,l=>{a(k)&&l($)})}var j=i(u,2);{var S=l=>{var d=Ka();v(l,d)},I=l=>{var d=Va(),f=o(d),_=o(f);{var b=Q=>{var V=Qa(),sa=o(V);e(V),C(()=>{F(sa,"src",a(p).book_image),F(sa,"alt",a(p).book_name)}),v(Q,V)};h(_,Q=>{a(p).book_image&&Q(b)})}e(f);var z=i(f,2),B=o(z),E=o(B,!0);e(B);var m=i(B,2),ja=o(m);e(m);var U=i(m,2),ea=i(o(U),2),G=i(ea,2),Ba=o(G,!0);e(G);var Ea=i(G,2);e(U);var K=i(U,2),Ma=o(K);e(K);var oa=i(K,2),ra=i(o(oa),2),Ra=o(ra,!0);e(ra),e(oa),e(z),e(d),C(()=>{M(E,a(p).book_name),M(ja,`${a(p).book_price??""} ‡∏ö‡∏≤‡∏ó`),M(Ba,a(y)),M(Ra,a(p).description)}),x("click",ea,()=>s(y,Math.max(1,a(y)-1))),x("click",Ea,()=>za(y)),x("click",Ma,()=>ua(a(p).seller_book_id,a(y))),v(l,d)};h(j,l=>{a(N)?l(S):l(I,!1)})}var w=i(j,2),J=o(w);e(w);var O=i(w,2),wa=i(o(O),2);{var Ta=l=>{var d=Xa();ia(d,4,()=>Array(4),la,(f,_)=>{var b=Wa();v(f,b)}),e(d),v(l,d)},$a=l=>{var d=tt();ia(d,5,()=>a(R),la,(f,_)=>{var b=Za(),z=o(b);{var B=E=>{var m=Ya();C(()=>{F(m,"src",a(_).book_image),F(m,"alt",a(_).book_name_originl||"Related Book")}),Ca(m),v(E,m)};h(z,E=>{a(_).book_image&&E(B)})}e(b),x("click",b,()=>ga(a(_).seller_book_id)),v(f,b)},f=>{var _=at();v(f,_)}),e(d),v(l,d)};h(wa,l=>{a(P)?l(Ta):l($a,!1)})}e(O),e(n),e(t),x("click",J,ba),v(r,t)};h(ta,r=>{fa()?r(ha):r(xa,!1)})}var ya=i(ta,2);{var ka=r=>{var t=ot(),n=o(t),u=i(o(n),2),$=o(u),j=o($),S=i(o(j),2);Fa(S),e(j),e($);var I=i($,2),w=o(I),J=i(w,2);e(I),e(u),e(n),e(t),Na(S,()=>a(L),O=>s(L,O)),x("click",w,Z),x("click",J,ma),v(r,t)};h(ya,r=>{a(H)&&r(ka)})}v(va,aa),Oa(),pa()}export{xt as component};
